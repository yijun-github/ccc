{"_id":"_design/lgbt_sentiment","views":{"language_sentiment":{"reduce":"function (keys, values, rereduce) {\n  var result = {\n    count: 0,\n    sentiment: 0\n  };\n  for (var i = 0; i < values.length; i++) {\n    result.count += values[i].count;\n    result.sentiment += Math.abs(values[i].sentiment);\n  }\n  return {\n    count: result.count,\n    sentiment: result.sentiment,\n    average_magnitude: result.sentiment/result.count,\n  };\n}","map":"function (doc) {\n  var keywords_lgbt = ['questioning','Gay','Same-sex marriage','lesbian','LGBT','Gender identity','asexual','Homophobia',\n    'Transphobia','bisexual','intersex','Coming out','Non-binary','Queer','Rainbow flag','trans','transgender','gender diverse',\n    'heterosexuality','sexual orientation'];\n  var content = doc.content;\n  var language = doc.language;\n  \n  var LGBT = false;\n  for (var i = 0; i < keywords_lgbt.length; i++) {\n    var keyword = keywords_lgbt[i];\n    // make it exact match so trans don't match transition\n    var pattern = new RegExp('\\\\b' + keyword + '\\\\b', 'i');\n    if (pattern.test(content)) {\n      LGBT = true;\n      break;\n    }\n  }\n  \n  if (LGBT && doc.language) {\n    var sentimentCategory;\n    if (doc.sentiment > 0) {\n      sentimentCategory = 'positive';\n    } else if (doc.sentiment < 0) {\n      sentimentCategory = 'negative';\n    } else {\n      sentimentCategory = 'neutral';\n    }\n    \n    emit([language, sentimentCategory], {count:1, sentiment:doc.sentiment});\n  }\n}"},"lgbt_overall":{"reduce":"function (keys, values, rereduce) {\n  if (rereduce) {\n    return sum(values);\n  } else {\n    return values.length;\n  }\n}","map":"function (doc) {\n  var keywords_lgbt = ['questioning','Gay','Same-sex marriage','lesbian','LGBT','Gender identity','asexual','Homophobia',\n    'Transphobia','bisexual','intersex','Coming out','Non-binary','Queer','Rainbow flag','trans','transgender','gender diverse',\n    'heterosexuality','sexual orientation'];\n  var content = doc.content;\n\n  var LGBT = false;\n  for (var i = 0; i < keywords_lgbt.length; i++) {\n    var keyword = keywords_lgbt[i];\n    // make it exact match so trans don't match transition\n    var pattern = new RegExp('\\\\b' + keyword + '\\\\b', 'i');\n    if (pattern.test(content)) {\n      LGBT = true;\n      break;\n    }\n  }\n  if (LGBT) {\n    var sentimentCategory;\n    if (doc.sentiment > 0) {\n      sentimentCategory = 'positive';\n    } else if (doc.sentiment < 0) {\n      sentimentCategory = 'negative';\n    } else {\n      sentimentCategory = 'neutral';\n    }\n    \n    emit([sentimentCategory], {count:1});\n  }\n}"}},"language":"javascript"}
